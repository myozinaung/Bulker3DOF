function tau_wave2 = waveDrift3DOF(variables,wind_wave,BF_No)
% Get variables
psi = variables(3);
u   = variables(4);

u_knot = u*(3600/1852);

%Rewrite the 'psi' within +/- 180 degrees
psi = rem(psi+sign(psi)*pi,2*pi)- sign(psi)*pi;

wave_r = psi - wind_wave;

%Rewrite the 'wave_r' within +/- 180 degrees
wave_r = rem(wave_r+sign(wave_r)*pi,2*pi)- sign(wave_r)*pi;
wave_r = rad2deg(wave_r);

if wave_r < 0   % when the relative wave dir is negative
    wave_r = - wave_r;    % change to positive to find in the lookup tables
    P_or_S = -1;          % but the forces and moments will be negative
else
    P_or_S = 1; % checker for Portside or Starboard side wave
end

% Break Points
dir   = [0 15 30 45 60 75 90 105 120 135 150 165 180];
speed = [0 2 4];

% 2nd Order Wave Force/Moment Data
if BF_No == 0
    X_w = [0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0;];
    Y_w = [0,0,0,0,0,0,0,0,0,0,0,0,0];

    N_w = [0,0,0,0,0,0,0,0,0,0,0,0,0];
    
elseif BF_No == 7.5
    X_w = [-128669.620632837,-127271.417908379,-122425.927591273,-113012.470867125,-96654.9365073518,-57114.1506145704,-21442.9414712627,39054.7617527493,114441.865774492,136553.095579870,138670.885149792,141292.120471413,136627.057296501;-206872.497711662,-201531.576150539,-190167.360396153,-174287.995172935,-135299.684939123,-71868.8287940202,-28283.5210042374,24291.8187930929,84349.1166925026,95400.6611409136,92861.7190757039,90005.4099381958,86723.2026413376;-275901.387068228,-266920.925422924,-253015.346931415,-230594.984738356,-178533.712182695,-93579.1051350053,-37743.9662949511,10045.8476693246,58436.3530666723,61791.2972565241,76556.2562992405,59275.2529326472,52834.4891058600];
    Y_w = [9.68933830388015e-11,63987.6441648588,156773.911179398,257781.678504212,352544.129104892,349825.554407771,313971.150947644,450392.972662418,368822.844269016,243154.131535129,136456.898495849,55362.7905941994,4.55089477673113e-10];

    N_w = [2.11248997624168e-08,1219923.25509236,2236019.36656716,2381643.01433613,4098986.45864253,9531844.51449122,12820822.2783438,11269149.7855459,9888184.47843009,7333202.98566237,5361753.51034694,2719701.47505013,4.46340970569780e-08];

elseif BF_No == 8
    X_w = [-170493.380433467,-167064.213799646,-156628.949440756,-140619.617935213,-119350.700797693,-71978.5351349926,-27629.9797308043,46049.4370019616,137700.304729057,168914.299193916,178525.687077962,187063.166379197,183910.217192592;-295257.871314122,-284840.311959535,-259521.573981504,-223160.346113551,-166131.199273002,-88971.0993776595,-37559.9828941411,27625.1706575895,102953.842210443,118346.758189260,117594.546835472,116159.164220660,112813.007024946;-423370.141126377,-408006.644128592,-376093.150375037,-321202.874622571,-229989.779934215,-114723.687258576,-48615.7278100612,9728.65130266382,72888.9479003299,78798.8024963430,98496.4949347894,76830.2406942883,68759.0794805011];
    Y_w = [1.17409092105645e-10,77255.9526334148,190776.294210611,316296.040822972,433978.603109735,426327.419561030,379403.389672856,551577.075450691,453269.290364779,297473.853922550,165685.769070642,66664.9566926002,5.47597931446676e-10];

    N_w = [2.88332984772845e-08,1680744.41149451,2970453.86324896,3048217.60708907,5105875.22762585,11867020.1129242,15968384.2137162,14221264.2596464,12602054.1881443,9325037.86045465,6815653.43547977,3487336.63598268,5.93603419367037e-08];

elseif BF_No == 9   
    X_w = [-276171.095578179,-270616.412435791,-253713.009011471,-227780.538142989,-193328.407903702,-116593.329640154,-44756.0002251044,74592.4764659877,223051.733280125,273613.244975269,289182.104688270,303011.410002666,297904.153468990;-478268.948574941,-461394.224331151,-420382.053722108,-361482.874696330,-269105.083119903,-144118.475024971,-60840.9640268732,44748.2103213846,166768.207216915,191702.186818966,190483.728758284,188158.646175616,182738.424602390;-685789.650089002,-660903.324373593,-609208.739450473,-520295.565504330,-372545.428653766,-185833.410765957,-78749.4433948095,15758.8070687777,118068.047838551,127641.035448621,159548.041381973,124452.290711410,111378.343621307];
    Y_w = [1.90183322749639e-10,125141.873687184,309026.063349420,512347.305795889,702973.605037258,690579.952346793,614570.779965946,893463.692465584,734221.329847083,481858.474122478,268383.559816909,107986.210840906,8.87018136888836e-10];

    N_w = [4.67051776987420e-08,2722528.13762750,4811644.27435372,4937608.68586331,8270673.92243512,19222611.0920094,25866143.0238709,23036097.4784358,20413244.8006305,15105020.0053644,11040232.0111903,5648908.93101323,9.61539423106939e-08];

elseif BF_No == 9.5   
    X_w = [-360703.215099363,-353449.810453036,-331375.094607803,-297506.232580305,-252508.985128104,-152280.407854365,-58455.7446498906,97424.4579236781,291330.283969143,357367.282336609,377700.125567660,395760.469540590,389088.787494899;-624642.129095362,-602607.641732627,-549050.649928869,-472131.629898437,-351483.534977551,-188235.555298252,-79463.8604485763,58446.9295502035,217819.048363248,250379.801281812,248784.228747294,245745.937752941,238668.397798415;-895660.078702327,-863166.169098996,-795663.524831793,-679551.730983937,-486588.918124425,-242722.910558987,-102853.876096495,20587.9812205416,154212.992665889,166708.054682779,208374.688577868,162535.159492073,145463.857241758];
    Y_w = [2.48304547741187e-10,163371.708742610,403387.030019359,668758.623426715,917579.267998896,901327.207912495,802308.164404739,1166268.86310127,958412.968059967,628967.096446181,350360.980096085,141006.696926417,1.15850615629932e-09];

    N_w = [6.10011041665202e-08,3554052.09787540,6285902.71592519,6451787.18949022,10804117.8298389,25114455.9341322,33783839.7836395,30088659.9743049,26658919.1638487,19727010.5809102,14417395.1898237,7375819.56244488,1.25569550576842e-07];

elseif BF_No == 10  
    X_w = [-456527.729425155,-447345.498108141,-419403.137345495,-376535.175297595,-319583.694697955,-192735.912262295,-73984.4085353768,123305.930484591,368718.171340617,452299.445775442,478035.724076524,500896.412453387,492453.804714046;-790607.853766740,-762712.901445371,-694917.272479399,-597553.323477607,-444847.178218618,-238236.662796379,-100573.838493403,73971.5313475949,275678.056827963,316895.451680332,314881.265906554,311037.762045405,302077.803934562;-1133652.27871857,-1092513.65865838,-1007059.34480589,-860080.424609200,-615840.402468473,-307194.005551889,-130177.651326113,26050.2729096120,195173.711733115,210998.446353843,263742.680651833,205727.256073964,184115.221088284];
    Y_w = [3.14384676382057e-10,206867.178952284,510839.002679652,846941.464683002,1162058.40832689,1141570.94163449,1015923.12606616,1476950.18550433,1213712.81056355,796541.559263688,443654.456023869,178507.817920682,1.46629528751011e-09];

    N_w = [7.72065182366956e-08,4500505.69689441,7953942.57597243,8162169.46030464,13671930.3615765,31776153.0296485,42758318.0598683,38080079.5051693,33744343.4459399,24969522.8660106,18250179.4470698,9337992.31453208,1.58948353615636e-07];

elseif BF_No == 11
    X_w = [-745359.378076420,-730370.897381469,-684755.566591905,-614768.738417894,-521786.145049870,-314673.186542809,-120793.316092938,201318.508756350,602006.719608112,738465.985765882,780481.900098796,817801.907761608,804015.502284383;-1290764.39957596,-1245232.19717406,-1134561.69457957,-975615.750844817,-726307.773449707,-388971.127940528,-164204.617880066,120775.100515850,450102.642906867,517386.386242493,514089.285184840,507810.941684789,493185.868888130;-1850797.58450598,-1783651.96661472,-1644164.08060945,-1404229.94410353,-1005490.38159305,-501564.139397282,-212537.892402524,42543.1330690098,318666.691875997,344486.566121837,430586.758819110,335863.669419165,300587.423753476];
    Y_w = [5.13098069355812e-10,337592.320018910,833561.480000942,1381926.99919036,1896091.53426335,1862508.17572543,1657894.60535198,2409985.26789285,1980470.54728016,1299701.53914074,723988.119026676,291377.119820604,2.39394436204039e-09];

    N_w = [1.26053062906598e-07,7344115.46787535,12989228.6590798,13332013.3720326,22325696.6093154,51896668.7076404,69811137.6779116,62175395.0250284,55088157.1784219,40764017.9582089,29792195.5289717,15241439.6427084,2.59477704121677e-07];

else
    X_w = [0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0;];
    Y_w = [0,0,0,0,0,0,0,0,0,0,0,0,0];

    N_w = [0,0,0,0,0,0,0,0,0,0,0,0,0];
end

if u_knot < 0 
    u_knot = 0;
elseif u_knot > 4
    u_knot = 4;
end

interpo_type = 'spline';

X_wave = interp2(dir,speed,X_w,wave_r,u_knot,interpo_type);
Y_wave = interp1(dir,Y_w,wave_r,interpo_type)*P_or_S;    
N_wave = interp1(dir,N_w,wave_r,interpo_type)*P_or_S; 
tau_wave2 = [X_wave; Y_wave; N_wave];
